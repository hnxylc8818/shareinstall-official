function removeChannel(e){console.log("删除")}var DfttModule=function(e){var a={name:"Index",typed:null,word:"",page:1,pageMax:1,init:function(){var e=this;e.tpl=$("#channelTmp").html(),e.writeAppkey(),e.writeAppName(),e.drawAppicon(),e.handlebarHelp(),e.renderList(),e.removeChannel(),e.searchList(),e.selectPage(),e.changePlate()},timetrans:function(e){return e=new Date(1e3*e),e.getFullYear()+"-"+(e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-"+(e.getDate()<10?"0"+e.getDate():e.getDate())+" "+(e.getHours()<10?"0"+e.getHours():e.getHours())+":"+(e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes())+":"+(e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds())},writeAppkey:function(){var e=$.cookie("appkey");e&&($("#app_key").text(e),$("#configAppKey").text(e))},drawAppicon:function(){var e=$.cookie("img");e&&$("#app_icon").attr("src",e)},writeAppName:function(){var e=$.cookie("appName");e&&$("#app_name").text(e)},renderList:function(){var e=this;$.ajax({url:"http://api.shareinstall.com/channel/getlist",type:"POST",data:{username:$.cookie("userName"),token:$.cookie("_token"),app_key:$.cookie("appkey"),page:e.page||1,size:10,search:{channel_name:e.word||""}},success:function(a){if("0"===a.code){e.pageMax=a.data.page.max,a.data.page.more=a.data.page.next<a.data.page.max,$.each(a.data.list,function(a,t){t.createTime=e.timetrans(t.createTime),t.stats={v:0,i:0,r:0}});var t=Handlebars.compile(e.tpl),n=t(a.data);$("#channelContainer").html(n),console.log(a.data)}}})},removeChannel:function(){var e=this;$("body").on("click",".img-link-lock",function(){var a=$(this).attr("data-id");layer.confirm("渠道被删除后，分发出去的渠道链接将失效，确定要删除吗？",{btn:["确定删除","取消"]},function(){e.requestRemove(a)})})},requestRemove:function(e){var a=this;$.ajax({url:"http://api.shareinstall.com/channel/delete",type:"POST",data:{username:$.cookie("userName"),token:$.cookie("_token"),app_key:$.cookie("appkey"),channel_id:e},success:function(e){0===parseInt(e.code)?(a.renderList(),layer.msg("删除成功")):layer.msg(e.message)},error:function(){layer.msg("删除失败")}})},searchList:function(){var e=this;$("#search_button").on("click",function(){e.word=$('input[name="search"]').val(),e.renderList()})},selectPage:function(){var e=this;$("body").on("click",".page-change",function(){e.page=$(this).attr("data-page"),e.renderList()}),$("body").on("click",".page-change-start",function(){e.page=1,e.renderList()}),$("body").on("click",".page-change-end",function(){e.page=e.pageMax,e.renderList()})},changePlate:function(){$(".data_profile li").on("click",function(){$(this).addClass("active").siblings("li").removeClass("active")})},handlebarHelp:function(){Handlebars.registerHelper("pager",function(e,a){console.log(e);var t="<ul class='pagination'>";if(e.prev>0?t+='<li><a href="javascript:;" class="page-change-start">&lt;</a></li>':t+="<li><a disabled='disabled' href='javascript:;' class='disabled_pre'>&lt;</a></li>",parseInt(e.curr)<4)for(var n=0;n<parseInt(e.curr)-1;n++)t=t+"<li><a href='javascript:;' class='page-change' data-page='"+(n+1)+"'>"+(n+1)+"</a></li>";else t=t+"<li><a href='javascript:;' class='page-change' data-page='"+(parseInt(e.curr)-3)+"'>"+(parseInt(e.curr)-2)+"</a></li>",t=t+"<li><a href='javascript:;' class='page-change' data-page='"+(parseInt(e.curr)-1)+"'>"+(parseInt(e.curr)-1)+"</a></li>";if(t=t+"<li class=\"active\"><a href='javascript:;'>"+parseInt(e.curr)+"</a></li>",e.max-parseInt(e.curr)<=3)for(var r=parseInt(e.curr);r<e.max;r++)t=t+"<li><a href='javascript:;' class='page-change' data-page='"+(r+1)+"'>"+(r+1)+"</a></li>";else t=t+"<li><a href='javascript:;' class='page-change' data-page='"+(parseInt(e.curr)+1)+"'>"+(parseInt(e.curr)+1)+"</a></li>",t=t+"<li><a href='javascript:;' class='page-change' data-page='"+(parseInt(e.curr)+2)+"'>"+(parseInt(e.curr)+2)+"</a></li>";return e.next<=e.max?t+='<li><a class="page-change-end" href="javascript:;">&gt;</a></li>':t+="<li><a disabled='disabled' href='javascript:;' class='disabled_pre'>&gt;</a></li>",t+"</ul>"}),Handlebars.registerHelper("more",function(e){return console.log(!!(e.next>e.max)),!!(e.next>e.max)})}};return e[a.name]=a,e}(DfttModule||{});$(function(){$.each(DfttModule,function(e,a){$.isPlainObject(a)?$.isFunction(a.init)||console.error(a.init+" is not a Function!"):console.error(a+" is not a PlainObject!")})});