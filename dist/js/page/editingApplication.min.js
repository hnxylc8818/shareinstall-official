var DfttModule=function(t){var e={name:"Index",typed:null,init:function(){var t=this;t.url="http://api.shareinstall.com/",t.getImg(),t.getAppInfo(),t.previewImg(),t.preservationOk(),t.cancelFun(),t.inputLimit(),t.payLink()},getImg:function(){var t=$.cookie("oldImg")?$.cookie("oldImg"):"http://mini.eastday.com/songheng/sharefolder/dftoutiao/s_window_activity_banner/20180115/5a5c5751b2b6d.png";$("#xmTanImg").attr("src",t);$.cookie("oldName")&&$.cookie("oldName")},previewImg:function(){var t=this;$("#fileImg").on("change",function(){console.log($(this[0].files[0]));var e=t.url+"appliance/upload";$("#form1").serialize();$("#username2").val($.cookie("userName")),$("#token").val($.cookie("_token"));var a=$("form[name=form1]"),n={url:e,type:"post",success:function(t){if(console.log(t),0==t.code){layer.msg("上传成功");var t=t.data,e=t.img;$("#xmTanImg").attr("src",e)}}};a.ajaxSubmit(n)})},getLength:function(t){return t.replace(/[\u0391-\uFFE5]/g,"aa").length},inputLimit:function(){var t=this,e=0;$("#appName").on("input propertychange",function(){var a=$(this).val();if(t.getLength(a)<=30&&(e=a.length),t.getLength(a)>30)return $(this).val($(this).val().substr(0,e)),!1})},preservationOk:function(){var t=this;$(".preservation").on("click",function(){var e=t.url+"appliance/update",a=$.cookie("appkey"),n=$("#xmTanImg").attr("src"),o=$("#appName").val();if(""==o)return void layer.tips("应用名不能为空",$("#addApp"),{tipsMore:!0,tips:[2,"#ff3333"]});$.ajax({url:e,type:"post",data:{username:$.cookie("userName"),token:$.cookie("_token"),app_name:o,app_icon:n,app_key:a},success:function(t){console.log(t),0==t.code?window.location.href="./application.html":88==parseInt(t.code)&&(layer.msg("登录失效，请重新登录"),setTimeout(function(){window.location.href="./login.html"},3e3))}})})},cancelFun:function(){$("body").on("click",".cancel",function(){window.location.href="./application.html"})},getQueryString:function(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)","i"),a=window.location.search.substr(1).match(e);return null!=a?decodeURIComponent(a[2]):null},timetrans:function(t){return t=new Date(1e3*t),t.getFullYear()+"-"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-"+(t.getDate()<10?"0"+t.getDate():t.getDate())+" "+(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":"+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())},getAppInfo:function(){var t=this;$.ajax({url:t.url+"/appliance/getone",data:{app_key:$.cookie("appkey")},type:"POST",success:function(e){e.code=parseInt(e.code),0===e.code?($("#appKey").text(e.data.app_key),$("#appTime").text(t.timetrans(e.data.createTime)),$("#appName").val(e.data.name),$("#xmTanImg").attr("src",e.data.icon),1===e.data.status?$("#appStatus").text("免费体验中"):2===e.data.status?$("#appStatus").text("已支付"):$("#appStatus").text("已过期"),$("#appOver").text(e.data.app_over_time)):88===e.code&&(layer.msg("登录已过期，请重新登录"),setTimeout(function(){window.location.href="./login.html"},3e3))}})},payLink:function(){$(".to-pay").click(function(){window.location.href="./payment.html?appkey="+$("#appKey").text()})}};return t[e.name]=e,t}(DfttModule||{});