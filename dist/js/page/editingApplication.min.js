var DfttModule=function(e){var t={name:"Index",typed:null,init:function(){var e=this;e.url=Tool.serverIP(),e.getImg(),e.getAppInfo(),e.previewImg(),e.preservationOk(),e.cancelFun(),e.payLink()},getImg:function(){var e=$.cookie("oldImg")?$.cookie("oldImg"):"http://mini.eastday.com/songheng/sharefolder/dftoutiao/s_window_activity_banner/20180115/5a5c5751b2b6d.png";$("#xmTanImg").attr("src",e);$.cookie("oldName")&&$.cookie("oldName")},previewImg:function(){var e=this;$("#fileImg").on("change",function(){var t=$("#fileImg")[0].files[0].size/1024/1024,a=e.url+"appliance/upload";$("#form1").serialize();if(t>1)return $("#fileImg").val(""),void layer.msg("图片大于1M，请重新选择");$("#username2").val($.cookie("userName")),$("#token").val($.cookie("_token"));var n=$("form[name=form1]"),o={url:a,type:"post",success:function(e){if(0==e.code){layer.msg("上传成功");var e=e.data,t=e.img;$("#xmTanImg").attr("src",t)}}};n.ajaxSubmit(o)})},getLength:function(e){return e.replace(/[\u0391-\uFFE5]/g,"aa").length},inputLimit:function(){var e=this,t=$("#appName").val().length;$("#appName").on("input propertychange",function(){var a=$(this).val();if(e.getLength(a)<=30&&(t=a.length),e.getLength(a)>30)return $(this).val($(this).val().substr(0,t)),!1})},preservationOk:function(){var e=this;$(".preservation").on("click",function(){var t=e.url+"appliance/update",a=$.cookie("appkey"),n=$("#xmTanImg").attr("src"),o=$("#appName").val(),i=/[`~!@#$%^&*()+<>?:"{},.\/;'[\]]/im,r=/[·！#￥（）：；“”‘、，|《。》？、【】[\]]/im;return""==o?void layer.tips("应用名不能为空",$("#appName"),{tipsMore:!0,tips:[2,"#ff3333"]}):i.test(o)||r.test(o)?void layer.tips("应用名不能包含特殊符号",$("#appName"),{tipsMore:!0,tips:[2,"#ff3333"]}):void $.ajax({url:t,type:"post",data:{username:$.cookie("userName"),token:$.cookie("_token"),app_name:o,app_icon:n,app_key:a},success:function(e){console.log(e),0==e.code?window.location.href="./application.html":88==parseInt(e.code)&&(layer.msg("登录失效，请重新登录"),setTimeout(function(){window.location.href="./login.html"},3e3))}})})},cancelFun:function(){$("body").on("click",".cancel",function(){window.location.href="./application.html"})},getQueryString:function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),a=window.location.search.substr(1).match(t);return null!=a?decodeURIComponent(a[2]):null},timetrans:function(e){return e=new Date(1e3*e),e.getFullYear()+"-"+(e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-"+(e.getDate()<10?"0"+e.getDate():e.getDate())+" "+(e.getHours()<10?"0"+e.getHours():e.getHours())+":"+(e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes())+":"+(e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds())},getAppInfo:function(){var e=this;$.ajax({url:e.url+"/appliance/getone",data:{app_key:$.cookie("appkey")},type:"POST",success:function(t){t.code=parseInt(t.code),0===t.code?($("#appKey").text(t.data.app_key),$("#appTime").text(e.timetrans(t.data.createTime)),$("#appName").val(t.data.name),$("#xmTanImg").attr("src",t.data.icon),1===t.data.status?$("#appStatus").text("免费体验中"):2===t.data.status?$("#appStatus").text("已付费"):$("#appStatus").text("已过期"),$("#appOver").text(t.data.app_over_time),e.inputLimit()):88===t.code&&(layer.msg("登录已过期，请重新登录"),setTimeout(function(){window.location.href="./login.html"},3e3))}})},payLink:function(){$(".to-pay").click(function(){window.location.href="./payment.html?appkey="+$("#appKey").text()})}};return e[t.name]=t,e}(DfttModule||{});