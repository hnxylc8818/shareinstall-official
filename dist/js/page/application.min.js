var DfttModule=function(i){var a={name:"Index",typed:null,init:function(){var i=this;i.url="http://api.shareinstall.com/",i.addApp(),i.closeApp(),i.addEdit(),i.detailed(),i.getList(),i.addAppOk()},addApp:function(){$("#J_add").on("click",function(){$("#J_my-addApp").show()})},addAppOk:function(){var i=this;$(".preservation").on("click",function(){var a=$("#addApp").val();if(""==a)return void alert("应用名不能为空");var e=i.url+"appliance/create";$.ajax({url:e,type:"post",data:{username:$.cookie("userName"),token:$.cookie("_token"),app_name:a},success:function(a){if(console.log(a),0==a.code){var a=a.data;$("#addApp").val(""),$("#J_my-addApp").hide(),i.getList()}}})})},closeApp:function(){$(".close").on("click",function(){$("#J_my-addApp").hide()}),$(".cancel").on("click",function(){$("#J_my-addApp").hide()})},addEdit:function(){$("body").on("click",".edit",function(){var i=$(this).attr("data-key"),a=$(this).parent().siblings(".item-icon").children("img").attr("src"),e=$(this).parent().siblings(".item-name").html();$.cookie("oldImg",a,{expires:7}),$.cookie("oldName",e,{expires:7}),window.location.href="./editingApplication.html?key="+i})},detailed:function(){$("body").on("click",".detailed",function(){var i=$(this).attr("data-key"),a=$(this).attr("data-img"),e=$(this).attr("data-name");$.cookie("appkey",i,{expires:7}),$.cookie("img",a,{expires:7}),$.cookie("appName",e,{expires:7}),window.location.href="./overview.html"})},getList:function(){var i=this,a=i.url+"appliance/getlist";$.ajax({url:a,type:"post",data:{username:$.cookie("userName"),token:$.cookie("_token"),page:1,size:10},success:function(a){if(console.log(a),0==a.code){var a=a.data,e=a.list;$(".list-ul").html(""),i.renderingList(e)}else alert("登录已过期，请重新登录"),window.location.href="./login.html"}})},renderingList:function(i){if(0==i.length){var a='<li class="item"><div class="nomore">暂无数据</div></li>';$(".list-ul").append(a)}else{for(var a="",e=0;e<i.length;e++){var t=i[e];t.name.indexOf("script")>0&&(t.name="&bnsp;"),a+=' <li class="item"><span class="item-appkey">'+t.app_key+'</span><span class="item-name">'+t.name+'</span><span class="item-icon icon"><img src="'+t.icon+'" alt=""></span><span class="item-pingtai">暂无</span><span class="item-operation"><button class="edit" data-key="'+t.app_key+'" data-img="'+t.icon+'">编辑</button><button class="detailed" data-name="'+t.name+'" data-key="'+t.app_key+'" data-img="'+t.icon+'">详细</button></span></li>'}$(".list-ul").append(a)}}};return i[a.name]=a,i}(DfttModule||{});$(function(){$.each(DfttModule,function(i,a){$.isPlainObject(a)?$.isFunction(a.init)||console.error(a.init+" is not a Function!"):console.error(a+" is not a PlainObject!")})});