var DfttModule=function(e){var i={name:"Index",typed:null,init:function(){var e=this;e.url="http://api.shareinstall.com/",e.addApp(),e.closeApp(),e.addEdit(),e.detailed(),e.getList(),e.addAppOk()},addApp:function(){$("#J_add").on("click",function(){$("#J_my-addApp").show()})},addAppOk:function(){var e=this,i=/[`~!@#$%^&*()_+<>?:"{},.\/;'[\]]/im,t=/[·！#￥（——）：；“”‘、，|《。》？、【】[\]]/im;$(".preservation").on("click",function(){var a=$("#addApp").val();if(""==a)layer.tips("应用名不能为空",$("#addApp"),{tipsMore:!0,tips:[2,"#ff3333"]});else if(i.test(a)||t.test(a))layer.tips("应用名不能包含特殊符号",$("#addApp"),{tipsMore:!0,tips:[2,"#ff3333"]});else{var n=e.url+"appliance/create";$.ajax({url:n,type:"post",data:{username:$.cookie("userName"),token:$.cookie("_token"),app_name:a},success:function(i){if(console.log(i),0==i.code){var i=i.data;$("#addApp").val(""),$("#J_my-addApp").hide(),e.getList()}else layer.msg(i.message)}})}})},closeApp:function(){$(".close").on("click",function(){$("#J_my-addApp").hide()}),$(".cancel").on("click",function(){$("#J_my-addApp").hide()})},addEdit:function(){$("body").on("click",".edit",function(){var e=$(this).attr("data-key"),i=$(this).parent().siblings(".item-icon").children("img").attr("src"),t=$(this).parent().siblings(".item-name").html();$.cookie("oldImg",i,{expires:7}),$.cookie("oldName",t,{expires:7}),window.location.href="./editingApplication.html?key="+e})},detailed:function(){$("body").on("click",".detailed",function(){var e=$(this).attr("data-key"),i=$(this).attr("data-img"),t=$(this).attr("data-name"),a=$(this).attr("data-scheme");$.cookie("appkey",e,{expires:7}),$.cookie("img",i,{expires:7}),$.cookie("appName",t,{expires:7}),$.cookie("scheme",a,{expires:7}),window.location.href="./overview.html"})},getList:function(){var e=this,i=e.url+"appliance/getlist";$.ajax({url:i,type:"post",data:{username:$.cookie("userName"),token:$.cookie("_token"),page:1,size:1e4},success:function(i){if(console.log(i),0==i.code){var i=i.data,t=i.list;$(".list-ul").html(""),e.renderingList(t)}else layer.msg("登录已过期，请重新登录"),setTimeout(function(){window.location.href="./login.html"},3e3)}})},renderingList:function(e){if(0==e.length){var i='<li class="item"><div class="nomore">暂无数据</div></li>';$(".list-ul").append(i)}else{for(var i="",t=0;t<e.length;t++){var a=e[t];a.name.indexOf("script")>0&&(a.name="name"),i+=' <li class="item"><span class="item-appkey">'+a.app_key+'</span><span class="item-name">'+a.name+'</span><span class="item-icon icon"><img src="'+a.icon+'" alt=""></span><span class="item-pingtai">暂无</span><span class="item-operation"><button class="edit" data-key="'+a.app_key+'" data-img="'+a.icon+'">编辑</button><button class="detailed" data-name="'+a.name+'" data-key="'+a.app_key+'" data-img="'+a.icon+'" data-scheme="'+a.scheme+'">详细</button></span></li>'}$(".list-ul").append(i)}}};return e[i.name]=i,e}(DfttModule||{});$(function(){$.each(DfttModule,function(e,i){$.isPlainObject(i)?$.isFunction(i.init)||console.error(i.init+" is not a Function!"):console.error(i+" is not a PlainObject!")})});