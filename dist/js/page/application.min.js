var DfttModule=function(t){var a={name:"Index",typed:null,init:function(){var t=this;t.url=Tool.serverIP(),t.addApp(),t.closeApp(),t.addEdit(),t.detailed(),t.getList(),t.addAppOk(),t.inputLimit(),t.nowPay()},addApp:function(){$("#J_add").on("click",function(){$("#J_my-addApp").show()})},getLength:function(t){return t.replace(/[\u0391-\uFFE5]/g,"aa").length},inputLimit:function(){var t=this,a=0;$("#addApp").on("input propertychange",function(){var e=$(this).val();if(t.getLength(e)<=30&&(a=e.length),t.getLength(e)>30)return $(this).val($(this).val().substr(0,a)),!1})},addAppOk:function(){var t=this,a=/[`~!@#$%^&*()+<>?:"{},.\/;'[\]]/im,e=/[·！#￥（）：；“”‘、，|《。》？、【】[\]]/im;$(".preservation").on("click",function(){var i=$("#addApp").val();if(""==i)layer.tips("应用名不能为空",$("#addApp"),{tipsMore:!0,tips:[2,"#ff3333"]});else if(a.test(i)||e.test(i))layer.tips("应用名不能包含特殊符号",$("#addApp"),{tipsMore:!0,tips:[2,"#ff3333"]});else if(t.getLength(i)>30)layer.tips("应用名不能超过30个字符",$("#addApp"),{tipsMore:!0,tips:[2,"#ff3333"]});else{var s=t.url+"appliance/create";$.ajax({url:s,type:"post",data:{username:$.cookie("userName"),token:$.cookie("_token"),app_name:i},success:function(a){if(console.log(a),0==a.code){var a=a.data;$("#addApp").val(""),$("#J_my-addApp").hide(),t.getList()}else layer.msg(a.message)}})}})},closeApp:function(){$(".close").on("click",function(){$("#J_my-addApp").hide()}),$(".cancel").on("click",function(){$("#J_my-addApp").hide()})},addEdit:function(){$("body").on("click",".edit",function(){var t=$(this).attr("data-key"),a=$(this).parent().siblings(".item-icon").children("img").attr("src"),e=$(this).parent().siblings(".item-name").html(),i=$(this).attr("data-status");$.cookie("oldImg",a,{expires:7}),$.cookie("oldName",e,{expires:7}),$.cookie("appkey",t,{expires:7}),$.cookie("status",i,{expires:7}),window.location.href="./editingApplication.html?key="+t})},detailed:function(){$("body").on("click",".detailed",function(){var t=$(this).attr("data-key"),a=$(this).attr("data-img"),e=$(this).attr("data-name"),i=$(this).attr("data-scheme"),s=$(this).attr("data-status");$.cookie("appkey",t,{expires:7}),$.cookie("img",a,{expires:7}),$.cookie("appName",e,{expires:7}),$.cookie("scheme",i,{expires:7}),$.cookie("status",s,{expires:7}),window.location.href="./overview.html"})},nowPay:function(){$("body").on("click","#nowPay",function(){var t=$(this).attr("data-key"),a=$(this).attr("data-img"),e=$(this).attr("data-name"),i=$(this).attr("data-status");$.cookie("appkey",t,{expires:7}),$.cookie("img",a,{expires:7}),$.cookie("appName",e,{expires:7}),$.cookie("status",i,{expires:7}),window.location.href="./payment.html"})},getList:function(){var t=this,a=t.url+"appliance/getlist";$.ajax({url:a,type:"post",data:{username:$.cookie("userName"),token:$.cookie("_token"),page:1,size:1e4},success:function(a){if(console.log(a),0==a.code){var a=a.data;a.list;$(".list-ul").html(""),t.renderingList(a.list)}else layer.msg("登录已过期，请重新登录"),setTimeout(function(){window.location.href="./login.html"},3e3)}})},renderingList:function(t){if(0==t.length){var a='<li class="item"><div class="nomore">暂无数据</div></li>';$(".list-ul").append(a)}else{for(var a="",e=0;e<t.length;e++){var i=t[e];i.name.indexOf("script")>0&&(i.name="name"),a+=' <li class="item">',a+='<span class="item-appkey">'+i.app_key+"</span>",a+='<span class="item-name">'+i.name+"</span>",a+='<span class="item-icon icon">',a+='<img src="'+i.icon+'" alt="">',a+="</span>",5===parseInt(i.plantform)?a+='<span class="item-pingtai">Android</span>':6===parseInt(i.plantform)?a+='<span class="item-pingtai">iOS</span>':7===parseInt(i.plantform)?a+='<span class="item-pingtai">Android/iOS</span>':a+='<span class="item-pingtai">暂无</span>',0===parseInt(i.app_status)?a+='<span class="item-status" style="color:#a6b2ca">已过期<a href="javascript:;" id="nowPay" style="color:#00a4ff;margin-left:5px"  data-key="'+i.app_key+'" data-img="'+i.icon+'" data-status="'+i.app_status+'">开通</a></span>':1===parseInt(i.app_status)?a+='<span class="item-status">免费体验中</span>':2===parseInt(i.app_status)?a+='<span class="item-status">已付费</span>':a+='<span class="item-status">已过期</span>',a+='<span class="item-operation">',a+='<button class="edit" data-key="'+i.app_key+'" data-img="'+i.icon+'" data-status="'+i.app_status+'">编辑</button>',a+='<button class="detailed" data-name="'+i.name+'" data-key="'+i.app_key+'" data-img="'+i.icon+'" data-scheme="'+i.scheme+'" data-status="'+i.app_status+'">详细</button>',a+="</span>",a+="</li>"}$(".list-ul").html(a)}}};return t[a.name]=a,t}(DfttModule||{});$(function(){$.each(DfttModule,function(t,a){$.isPlainObject(a)?$.isFunction(a.init)||console.error(a.init+" is not a Function!"):console.error(a+" is not a PlainObject!")})});