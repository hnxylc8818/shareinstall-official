var DfttModule=function(e){var o={name:"Index",typed:null,init:function(){var e=this;e.url=Tool.serverIP(),e.goSign(),e.goRegister(),e.registerFun(),e.signFun(),e.forgetFun(),e.registerVerification(),e.forgetPass()},goSign:function(){$(".hlogin a").on("click",function(e){e.preventDefault(),$(".section h2").html("注册账号"),$(".login").hide(),$(".nologin").show(),$(".forgetPassword").hide()})},goRegister:function(){$(".hregister a").on("click",function(e){e.preventDefault(),$(".section h2").html("登录账号"),$(".login").show(),$(".nologin").hide(),$(".forgetPassword").hide()})},registerVerification:function(){var e=this,o=!1,t=!1,r=!1,a=!1,n=!1;$(".Ruser").on("blur",function(){var e=$(".Ruser").val(),t=/^([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/;""!=e&&t.test(e)?($(".Ruser").css("border-color","rgba(235, 240, 244, 0.3)"),o=!0):$(".Ruser").css("border-color","rgba(231, 94, 94, 0.3)")}),$(".Rpassword").on("blur",function(){""==$(".Rpassword").val()?$(".Rpassword").css("border-color","rgba(231, 94, 94, 0.3)"):($(".Rpassword").css("border-color","rgba(235, 240, 244, 0.3)"),t=!0)}),$(".Rpasswordsc").on("blur",function(){$(".Rpasswordsc").val()!=$(".Rpassword").val()?$(".Rpasswordsc").css("border-color","rgba(231, 94, 94, 0.3)"):($(".Rpasswordsc").css("border-color","rgba(235, 240, 244, 0.3)"),r=!0)}),$(".Rphone").on("blur",function(){var e=$(".Rphone").val(),o=/^1[34578]\d{9}$/;""!=e&&o.test(e)?($(".Rphone").css("border-color","rgba(235, 240, 244, 0.3)"),a=!0):$(".Rphone").css("border-color","rgba(231, 94, 94, 0.3)")}),$(".erification").on("click",function(){var o=$(".Rphone").val(),t=/^1[34578]\d{9}$/,r=$(".erification").attr("data-click"),a=e.url+"login/sendmessage";if(""==o||!t.test(o))return $(".my-code").css("border-color","rgba(231, 94, 94, 0.3)"),!1;1==r&&($(".erification").attr("data-click","0"),$.ajax({url:a,type:"post",data:{mobile_num:o},success:function(e){function o(){t>1?(t--,$(".erification").html(t+"s重新发送")):(t=60,$(".erification").html("获取验证码"),$(".erification").attr("data-click","1"),clearInterval(r))}if("string"==typeof e&&(e=JSON.parse(e)),console.log(e),0==e.code){$(".prompt").html("验证码发送成功"),$(".prompt").stop(!0).fadeIn(1e3).delay(1e3).fadeOut(1e3),n=!0;var t=60,r=setInterval(function(){o()},1e3)}else $(".erification").attr("data-click","1"),$(".prompt").html(e.message),$(".prompt").stop(!0).fadeIn(1e3).delay(1e3).fadeOut(1e3)}}))})},registerFun:function(){var e=this;$(".register").on("click",function(){var o=$(".Ruser").val(),t=$(".Rpassword").val(),r=$(".Rpasswordsc").val(),a=$(".Rphone").val(),n=$(".Rcode").val(),s=/^1[0-9]{10}$/,i=/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+/,p=e.url+"login/register";return""==o?($(".prompt").html("邮箱是必填项"),void $(".prompt").stop(!0).fadeIn(1e3).delay(1e3).fadeOut(1e3)):i.test(o)?""==t?($(".prompt").html("请输入密码"),void $(".prompt").stop(!0).fadeIn(1e3).delay(1e3).fadeOut(1e3)):t.length<6||t.length>12?($(".prompt").html("密码为6-12位（数字、英文字母）组合"),void $(".prompt").stop(!0).fadeIn(1e3).delay(1e3).fadeOut(1e3)):r?r!==t?($(".prompt").html("两次密码输入不一致"),void $(".prompt").stop(!0).fadeIn(1e3).delay(1e3).fadeOut(1e3)):""==a?($(".prompt").html("请输入绑定手机号"),void $(".prompt").stop(!0).fadeIn(1e3).delay(1e3).fadeOut(1e3)):s.test(a)?""==n?($(".prompt").html("手机验证码为空"),void $(".prompt").stop(!0).fadeIn(1e3).delay(1e3).fadeOut(1e3)):6!==n.length?($(".prompt").html("手机验证码应为6位数字"),void $(".prompt").stop(!0).fadeIn(1e3).delay(1e3).fadeOut(1e3)):void $.ajax({url:p,type:"post",data:{mobile:a,email:o,password:t,sc_pd:r,code:n},success:function(e){"string"==typeof e&&(e=JSON.parse(e)),"0"==e.code?($(".prompt").html("注册成功"),$(".prompt").stop(!0).fadeIn(1e3).delay(1e3).fadeOut(1e3),setTimeout(function(){$(".section h2").html("登录账号"),$(".login").show(),$(".nologin").hide()},3e3)):($(".prompt").html(e.message),$(".prompt").stop(!0).fadeIn(1e3).delay(1e3).fadeOut(1e3))}}):($(".prompt").html("手机号格式错误"),void $(".prompt").stop(!0).fadeIn(1e3).delay(1e3).fadeOut(1e3)):($(".prompt").html("请再次输入密码"),void $(".prompt").stop(!0).fadeIn(1e3).delay(1e3).fadeOut(1e3)):($(".prompt").html("邮箱格式错误"),void $(".prompt").stop(!0).fadeIn(1e3).delay(1e3).fadeOut(1e3))})},signFun:function(){var e=this;$(".sign").on("click",function(){var o=$(".user").val(),t=$(".password").val(),r=e.url+"login/loginwithpwd";if(!o||!t)return $(".prompt").html("用户名或密码为空"),void $(".prompt").stop(!0).fadeIn(1e3).delay(1e3).fadeOut(1e3);$.ajax({url:r,type:"post",data:{username:o,password:t},success:function(e){if("string"==typeof e&&(e=JSON.parse(e)),console.log(e),"0"==e.code){var o=e.data.login_token,t=$(".user").val();$.cookie("_token",o,{expires:7}),$.cookie("userName",t,{expires:7}),window.location.href="./application.html"}else $(".prompt").html(e.message),$(".prompt").stop(!0).fadeIn(1e3).delay(1e3).fadeOut(1e3)}})}),$(".login").on("keyup",function(e){13===e.keyCode&&$(".sign").click()})},forgetFun:function(){$(".forget a").on("click",function(e){e.preventDefault(),$(".section h2").html("忘记密码"),$(".login").hide(),$(".nologin").hide(),$(".forgetPassword").show()})},forgetPass:function(){var e=this,o=!1,t=!1,r=!1;$(".phone-w").on("blur",function(){var e=$(".phone-w").val(),o=/^1[345678]\d{9}$/;""!=e&&o.test(e)?(r=!0,$(".phone-w").css("border-color","rgba(235, 240, 244, 0.3)")):$(".phone-w").css("border-color","rgba(231, 94, 94, 0.3)")}),$(".erification-w").on("click",function(){var o=$(".phone-w").val(),r=/^1[345678]\d{9}$/,a=$(".erification-w").attr("data-click"),n=e.url+"changepwd/getsms";if(""==o)return $(".prompt").html("手机号为空"),$(".prompt").stop(!0).fadeIn(1e3).delay(1e3).fadeOut(1e3),!1;if(r.test(o)){if(1!=a)return;$(".erification-w").attr("data-click","0"),$.ajax({url:n,type:"post",data:{mobile_num:o},success:function(e){function o(){r>1?(r--,$(".erification-w").html(r+"s重新发送")):(r=60,$(".erification-w").html("获取验证码"),$(".erification-w").attr("data-click","1"),clearInterval(a))}if("string"==typeof e&&(e=JSON.parse(e)),console.log(e),0==e.code){t=!0;var r=60,a=setInterval(function(){o()},1e3)}else $(".prompt").html(e.message),$(".prompt").stop(!0).fadeIn(1e3).fadeOut(1e3)}})}else $(".prompt").html("手机号格式错误"),$(".prompt").stop(!0).fadeIn(1e3).delay(1e3).fadeOut(1e3)}),$(".password-w").on("blur",function(){""==$(".password-w").val()?$(".password-w").css("border-color","rgba(231, 94, 94, 0.3)"):($(".password-w").css("border-color","rgba(235, 240, 244, 0.3)"),o=!0)}),$(".confirm").on("click",function(){var o=e.url+"changepwd/update",t=$(".phone-w").val(),r=$(".code-w").val(),a=$(".password-w").val(),n=/^1[345678]\d{9}$/;return""==t?($(".prompt").html("手机号为空"),$(".prompt").stop(!0).fadeIn(1e3).delay(1e3).fadeOut(1e3),!1):n.test(t)?""==r?($(".prompt").html("手机验证码为空"),$(".prompt").stop(!0).fadeIn(1e3).delay(1e3).fadeOut(1e3),!1):6!==r.length?($(".prompt").html("手机验证码为6位数字"),$(".prompt").stop(!0).fadeIn(1e3).delay(1e3).fadeOut(1e3),!1):""==a?($(".prompt").html("密码为空"),$(".prompt").stop(!0).fadeIn(1e3).delay(1e3).fadeOut(1e3),!1):a.length<6||a.length>12?($(".prompt").html("密码为6-12位（数字、英文字母）组合"),$(".prompt").stop(!0).fadeIn(1e3).delay(1e3).fadeOut(1e3),!1):void $.ajax({url:o,type:"post",data:{mobile_num:t,sms_code:r,password:a},success:function(e){"string"==typeof e&&(e=JSON.parse(e)),console.log(e),0==e.code?($(".prompt").html("密码重置成功，前往登录"),$(".prompt").stop(!0).fadeIn(1e3).delay(1e3).fadeOut(1e3),setTimeout(function(){$(".login").show(),$(".nologin").hide(),$(".forgetPassword").hide()},3e3)):($(".prompt").html(e.message),$(".prompt").stop(!0).fadeIn(1e3).delay(1e3).fadeOut(1e3))}}):($(".prompt").html("手机号格式错误"),$(".prompt").stop(!0).fadeIn(1e3).delay(1e3).fadeOut(1e3),!1)})}};return e[o.name]=o,e}(DfttModule||{});$(function(){$.each(DfttModule,function(e,o){$.isPlainObject(o)?$.isFunction(o.init)?o.init():console.error(o.init+" is not a Function!"):console.error(o+" is not a PlainObject!")})});