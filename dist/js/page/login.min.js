var DfttModule=function(o){var e={name:"Index",typed:null,init:function(){var o=this;o.url="http://api.shareinstall.com/",o.goSign(),o.goRegister(),o.registerFun(),o.signFun(),o.forgetFun(),o.registerVerification(),o.forgetPass()},goSign:function(){$(".hlogin a").on("click",function(o){o.preventDefault(),$(".section h2").html("注册账号"),$(".login").hide(),$(".nologin").show(),$(".forgetPassword").hide()})},goRegister:function(){$(".hregister a").on("click",function(o){o.preventDefault(),$(".section h2").html("登录账号"),$(".login").show(),$(".nologin").hide(),$(".forgetPassword").hide()})},registerVerification:function(){var o=this,e=!1,r=!1,t=!1,n=!1,s=!1;$(".Ruser").on("blur",function(){var o=$(".Ruser").val(),r=/^([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/;""!=o&&r.test(o)?($(".Ruser").css("border-color","rgba(235, 240, 244, 0.3)"),e=!0):$(".Ruser").css("border-color","rgba(231, 94, 94, 0.3)")}),$(".Rpassword").on("blur",function(){""==$(".Rpassword").val()?$(".Rpassword").css("border-color","rgba(231, 94, 94, 0.3)"):($(".Rpassword").css("border-color","rgba(235, 240, 244, 0.3)"),r=!0)}),$(".Rpasswordsc").on("blur",function(){$(".Rpasswordsc").val()!=$(".Rpassword").val()?$(".Rpasswordsc").css("border-color","rgba(231, 94, 94, 0.3)"):($(".Rpasswordsc").css("border-color","rgba(235, 240, 244, 0.3)"),t=!0)}),$(".Rphone").on("blur",function(){var o=$(".Rphone").val(),e=/^1[34578]\d{9}$/;""!=o&&e.test(o)?($(".Rphone").css("border-color","rgba(235, 240, 244, 0.3)"),n=!0):$(".Rphone").css("border-color","rgba(231, 94, 94, 0.3)")}),$(".erification").on("click",function(){var e=$(".Rphone").val(),r=/^1[34578]\d{9}$/,t=$(".erification").attr("data-click"),n=o.url+"login/sendmessage";if(""==e||!r.test(e))return $(".my-code").css("border-color","rgba(231, 94, 94, 0.3)"),!1;1==t&&($(".erification").attr("data-click","0"),$.ajax({url:n,type:"post",data:{mobile_num:e},success:function(o){function e(){r>1?(r--,$(".erification").html(r+"s重新发送")):(r=60,$(".erification").html("获取验证码"),$(".erification").attr("data-click","1"),clearInterval(t))}if("string"==typeof o&&(o=JSON.parse(o)),console.log(o),0==o.code){s=!0;var r=60,t=setInterval(function(){e()},1e3)}else $(".erification").attr("data-click","1"),$(".prompt").html(o.message),$(".prompt").stop(!0).fadeIn(1e3).fadeOut(1e3)}}))})},registerFun:function(){var o=this;$(".register").on("click",function(){var e=$(".Ruser").val(),r=$(".Rpassword").val(),t=$(".Rpasswordsc").val(),n=$(".Rphone").val(),s=$(".Rcode").val(),a=o.url+"login/register";$.ajax({url:a,type:"post",data:{mobile:n,email:e,password:r,sc_pd:t,code:s},success:function(o){"string"==typeof o&&(o=JSON.parse(o)),"0"==o.code?(alert("注册成功"),$(".section h2").html("登录账号"),$(".login").show(),$(".nologin").hide()):($(".prompt").html(o.message),$(".prompt").stop(!0).fadeIn(1e3).fadeOut(1e3))}})})},signFun:function(){var o=this;$(".sign").on("click",function(){var e=$(".user").val(),r=$(".password").val(),t=o.url+"login/loginwithpwd";$.ajax({url:t,type:"post",data:{username:e,password:r},success:function(o){if("string"==typeof o&&(o=JSON.parse(o)),console.log(o),"0"==o.code){var e=o.data.login_token,r=$(".user").val();$.cookie("_token",e,{expires:7}),$.cookie("userName",r,{expires:7}),window.location.href="./application.html"}else $(".prompt").html(o.message),$(".prompt").stop(!0).fadeIn(1e3).fadeOut(1e3)}})}),$(".login").on("keyup",function(o){13===o.keyCode&&$(".sign").click()})},forgetFun:function(){$(".forget a").on("click",function(o){o.preventDefault(),$(".section h2").html("忘记密码"),$(".login").hide(),$(".nologin").hide(),$(".forgetPassword").show()})},forgetPass:function(){var o=this,e=!1,r=!1,t=!1;$(".phone-w").on("blur",function(){var o=$(".phone-w").val(),e=/^1[34578]\d{9}$/;""!=o&&e.test(o)?(t=!0,$(".phone-w").css("border-color","rgba(235, 240, 244, 0.3)")):$(".phone-w").css("border-color","rgba(231, 94, 94, 0.3)")}),$(".erification-w").on("click",function(){var e=$(".phone-w").val(),t=/^1[34578]\d{9}$/,n=$(".erification-w").attr("data-click"),s=o.url+"changepwd/getsms";if(""==e||!t.test(e))return $(".my-code").css("border-color","rgba(231, 94, 94, 0.3)"),!1;1==n&&($(".erification-w").attr("data-click","0"),$.ajax({url:s,type:"post",data:{mobile_num:e},success:function(o){function e(){t>1?(t--,$(".erification-w").html(t+"s重新发送")):(t=60,$(".erification-w").html("获取验证码"),$(".erification-w").attr("data-click","1"),clearInterval(n))}if("string"==typeof o&&(o=JSON.parse(o)),console.log(o),0==o.code){r=!0;var t=60,n=setInterval(function(){e()},1e3)}else $(".prompt").html(o.message),$(".prompt").stop(!0).fadeIn(1e3).fadeOut(1e3)}}))}),$(".password-w").on("blur",function(){""==$(".password-w").val()?$(".password-w").css("border-color","rgba(231, 94, 94, 0.3)"):($(".password-w").css("border-color","rgba(235, 240, 244, 0.3)"),e=!0)}),$(".confirm").on("click",function(){var n=o.url+"changepwd/update",s=$(".phone-w").val(),a=$(".code-w").val(),i=$(".password-w").val();e&&r&&t&&$.ajax({url:n,type:"post",data:{mobile_num:s,sms_code:a,password:i},success:function(o){"string"==typeof o&&(o=JSON.parse(o)),console.log(o),0==o.code?($(".login").show(),$(".nologin").hide(),$(".forgetPassword").hide()):($(".prompt").html(o.message),$(".prompt").stop(!0).fadeIn(1e3).fadeOut(1e3))}})})}};return o[e.name]=e,o}(DfttModule||{});$(function(){$.each(DfttModule,function(o,e){$.isPlainObject(e)?$.isFunction(e.init)?e.init():console.error(e.init+" is not a Function!"):console.error(e+" is not a PlainObject!")})});